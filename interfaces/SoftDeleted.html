<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>cc-ui documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>
          <script>
               // Blocking script to avaoid flickering dark mode
               // Dark mode toggle button
               var useDark = window.matchMedia('(prefers-color-scheme: dark)');
               var darkModeState = useDark.matches;
               var $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               var $darkModeToggles = document.querySelectorAll('.dark-mode-switch');
               var darkModeStateLocal = localStorage.getItem('compodoc_darkmode-state');

               function checkToggle(check) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].checked = check;
                    }
               }

               function toggleDarkMode(state) {
                    if (window.localStorage) {
                         localStorage.setItem('compodoc_darkmode-state', state);
                    }

                    checkToggle(state);

                    const hasClass = document.body.classList.contains('dark');

                    if (state) {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.add('dark');
                         }
                         if (!hasClass) {
                              document.body.classList.add('dark');
                         }
                    } else {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.remove('dark');
                         }
                         if (hasClass) {
                              document.body.classList.remove('dark');
                         }
                    }
               }

               useDark.addEventListener('change', function (evt) {
                    toggleDarkMode(evt.matches);
               });
               if (darkModeStateLocal) {
                    darkModeState = darkModeStateLocal === 'true';
               }
               toggleDarkMode(darkModeState);

               if ($darkModeToggles.length > 0) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].addEventListener('change', function (event) {
                              darkModeState = !darkModeState;
                              toggleDarkMode(darkModeState);
                         });
                    }
               }
          </script>

        <div class="navbar navbar-default navbar-fixed-top d-block d-sm-none">
            <a href="../" class="navbar-brand">cc-ui documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content interface">
                   <div class="content-data">













<ol class="breadcrumb">
  <li class="breadcrumb-item">Interfaces</li>
  <li class="breadcrumb-item"
  >
  SoftDeleted</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="nav-item">
            <a href="#info" 
                class="nav-link"
                class="nav-link active"
                role="tab" id="info-tab" data-bs-toggle="tab" data-link="info">Info</a>
        </li>
        <li class="nav-item">
            <a href="#source" 
                class="nav-link"
                
                role="tab" id="source-tab" data-bs-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/pages/soft-delete-entities/soft-delete-entities.component.ts</code>
        </p>




        <section data-compodoc="block-index">
            <h3 id="index">Index</h3>
            <table class="table table-sm table-bordered index-table">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <h6><b>Properties</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#entityType" 
>
                                            entityType
                                        </a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#id" 
>
                                            id
                                        </a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#lastModifiedDate" 
>
                                            lastModifiedDate
                                        </a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#name" 
>
                                            name
                                        </a>
                                </li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>



            <section data-compodoc="block-properties">
                <h3 id="inputs">Properties</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="entityType"></a>
                                        <span class="name "><b>entityType</b>
                                            <a href="#entityType">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>entityType:     <code>&quot;CLUSTER&quot; | &quot;BLUE_PRINT&quot; | &quot;TEMPLATE_INPUT&quot;</code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>&quot;CLUSTER&quot; | &quot;BLUE_PRINT&quot; | &quot;TEMPLATE_INPUT&quot;</code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="id"></a>
                                        <span class="name "><b>id</b>
                                            <a href="#id">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>id:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="lastModifiedDate"></a>
                                        <span class="name "><b>lastModifiedDate</b>
                                            <a href="#lastModifiedDate">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>lastModifiedDate:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="name"></a>
                                        <span class="name "><b>name</b>
                                            <a href="#name">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>name:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                        </tbody>
                    </table>
            </section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Component, ViewChild, TemplateRef } from &#x27;@angular/core&#x27;;
import { ActivatedRoute, Params } from &#x27;@angular/router&#x27;;
import { UiVersioningControllerService } from &#x27;src/app/cc-api/services&#x27;;
import { FacetsPage } from &#x27;src/app/facets/facets-page/facets-page.component&#x27;;
import { LocalDataSource } from &#x27;ng2-smart-table&#x27;;
import { DatePipe } from &#x27;@angular/common&#x27;;
import { NbDialogService } from &#x27;@nebular/theme&#x27;;
import { CustomActionsComponent } from &#x27;src/app/components/custom-actions/custom-actions.component&#x27;;
import { SoftDeleteCheckboxComponent } from &#x27;./soft-delete-checkbox/soft-delete-checkbox.component&#x27;;
import { ContextUpdatesService } from &#x27;src/app/services/context-updates.service&#x27;;
import { OnAPIErrorService } from &#x27;src/app/services/on-api-error.service&#x27;;
import { CustomToastService } from &#x27;../custom-toast/custom-toast.service&#x27;;
const emptyStateLogo &#x3D; &#x27;./assets/trash-empty.svg&#x27;;
const errorIcon &#x3D; &#x27;./assets/error.svg&#x27;;

export interface SoftDeleted {
  entityType?: &#x27;CLUSTER&#x27; | &#x27;BLUE_PRINT&#x27; | &#x27;TEMPLATE_INPUT&#x27;;
  id?: string;
  name?: string;
  lastModifiedDate?: string;
}

@Component({
  selector: &#x27;app-soft-delete-entities&#x27;,
  templateUrl: &#x27;./soft-delete-entities.component.html&#x27;,
  styleUrls: [&#x27;./soft-delete-entities.component.scss&#x27;],
})
export class SoftDeleteEntitiesComponent extends FacetsPage {
  smartTableCustomActionButtons &#x3D; [
    {
      id: &#x27;edit&#x27;,
      icon: &#x27;refresh-outline&#x27;,
      toolTip: &#x27;&#x27;,
      status: &#x27;primary&#x27;,
      size: &#x27;medium&#x27;,
      appearance: &#x27;ghost&#x27;,
      action: &#x27;TRASH_RESTORE&#x27;,
      iconClass: &#x27;image-flip&#x27;,
      onClick: (data) &#x3D;&gt; {
        this.customClicked(data);
      },
    },
    {
      id: &#x27;delete&#x27;,
      icon: &#x27;trash-2-outline&#x27;,
      toolTip: &#x27;&#x27;,
      status: &#x27;danger&#x27;,
      size: &#x27;medium&#x27;,
      appearance: &#x27;ghost&#x27;,
      action: &#x27;TRASH_DELETE&#x27;,
      onClick: (data) &#x3D;&gt; {
        this.openDeletePopup(data);
      },
    },
  ];
  @ViewChild(&#x27;confirmDeleteAll&#x27;, { static: true })
  private confirmDeleteAll: TemplateRef&lt;any&gt;;
  @ViewChild(&#x27;confirmDelete&#x27;, { static: true })
  private confirmDelete: TemplateRef&lt;any&gt;;
  @ViewChild(&#x27;multipleDelete&#x27;, { static: true })
  private multipleDelete: TemplateRef&lt;any&gt;;
  @ViewChild(&#x27;confirmRestore&#x27;, { static: true })
  private confirmRestore: TemplateRef&lt;any&gt;;
  fetchingEntity: boolean &#x3D; true;
  entities: any &#x3D; [];
  source: LocalDataSource &#x3D; new LocalDataSource();
  restoreInProgress: boolean &#x3D; false;
  pageNum: number &#x3D; -1;
  pageCount: number &#x3D; 0;
  disableMore: boolean &#x3D; false;
  emptyStateLogo &#x3D; emptyStateLogo;
  primaryMsg: string &#x3D; &#x27;Trash is empty&#x27;;
  secondaryMsg: string &#x3D; &#x27;There are no entities removed&#x27;;
  showEmptyState: boolean &#x3D; false;
  status: &#x27;info&#x27; | &#x27;error&#x27; &#x3D; &#x27;info&#x27;;
  clearTrashInProgress: boolean &#x3D; false;
  deletionInProgress: boolean &#x3D; false;
  deleteEntitiesId: string[] &#x3D; [];
  deleteLength: number &#x3D; 0;
  showLoadMore: boolean &#x3D; true;
  entityNames: any &#x3D; {
    CLUSTER: &#x27;environment&#x27;,
    BLUE_PRINT: &#x27;blueprint&#x27;,
    TEMPLATE_INPUT: &#x27;template input&#x27;,
    USER_GROUP: &#x27;user group&#x27;,
    ACCOUNT: &#x27;account&#x27;,
    CONTROL_PLANE: &#x27;control plane&#x27;,
    ARTIFACTORY: &#x27;artifactory&#x27;,
    ARTIFACT_CI: &#x27;artifact CI&#x27;,
    IAC: &#x27;IaC&#x27;,
  };
  trashActionButtons &#x3D; [
    {
      id: &#x27;delete-trash&#x27;,
      icon: &#x27;trash-2-outline&#x27;,
      title: &#x27;Empty Trash&#x27;,
      buttonType: &#x27;secondary&#x27;,
      nbTooltip: &#x27;Delete all the trash entries&#x27;,
      action: &#x27;TRASH_DELETE&#x27;,
      status: &#x27;danger&#x27;,
      invisible: true,
      loading: false,
    },
  ];
  tableSettings: any &#x3D; {
    columns: {
      delete: {
        type: &#x27;custom&#x27;,
        renderComponent: SoftDeleteCheckboxComponent,
        onComponentInitFunction: (instance: any) &#x3D;&gt; {
          instance.change.subscribe((data) &#x3D;&gt; {
            this.changeDeleteStatus(data);
          });
        },
        filter: false,
        width: &#x27;5%&#x27;,
      },
      name: {
        title: &#x27;Entity Name&#x27;,
        type: &#x27;text&#x27;,
        width: &#x27;20%&#x27;,
        filter: true,
        class: &#x27;entity-name&#x27;,
      },
      id: {
        title: &#x27;Entity ID&#x27;,
        filter: true,
        type: &#x27;text&#x27;,
        width: &#x27;20%&#x27;,
      },
      lastModifiedDate: {
        title: &#x27;Deletion Date&#x27;,
        width: &#x27;25%&#x27;,
        filter: false,
        type: &#x27;text&#x27;,
        valuePrepareFunction(date, row) {
          if (date) {
            return new DatePipe(&#x27;en-GB&#x27;).transform(
              date,
              &#x27;dd/MM/yyyy, h:mm a zzzz&#x27;,
            );
          }
          return null;
        },
      },
      entityType: {
        title: &#x27;Entity Type&#x27;,
        type: &#x27;text&#x27;,
        width: &#x27;15%&#x27;,
        filter: {
          type: &#x27;list&#x27;,
          config: {
            selectText: &#x27;Entity Type&#x27;,
            list: [
              { value: &#x27;ACCOUNT&#x27;, title: &#x27;Account&#x27; },
              { value: &#x27;ARTIFACTORY&#x27;, title: &#x27;Container Registry&#x27; },
              { value: &#x27;ARTIFACT_CI&#x27;, title: &#x27;Artifact CI&#x27; },
              { value: &#x27;BLUE_PRINT&#x27;, title: &#x27;Blueprint&#x27; },
              { value: &#x27;CLUSTER&#x27;, title: &#x27;Environment&#x27; },
              { value: &#x27;CONTROL_PLANE&#x27;, title: &#x27;Control Plane&#x27; },
              { value: &#x27;IAC&#x27;, title: &#x27;IaC&#x27; },
              { value: &#x27;TEMPLATE_INPUT&#x27;, title: &#x27;Template Input&#x27; },
              { value: &#x27;USER_GROUP&#x27;, title: &#x27;User Group&#x27; },
            ],
          },
        },
      },
      custom: {
        type: &#x27;custom&#x27;,
        title: &#x27;Actions&#x27;,
        valuePrepareFunction: (value, row, cell) &#x3D;&gt; {
          // Data from here goes to renderComponent. rowData property holds row data and any custom data sent will reside in value
          const displayVal &#x3D; {};
          //Based on entity types, different restore/write permissions are configured for the custom RBAC button.
          this.smartTableCustomActionButtons[0][&#x27;toolTip&#x27;] &#x3D;
            &#x27;Restore &#x27; + this.entityNames?.[row?.entityType];
          this.smartTableCustomActionButtons[1][&#x27;toolTip&#x27;] &#x3D;
            &#x27;Delete &#x27; + this.entityNames?.[row?.entityType];
          displayVal[&#x27;smartTableCustomActionButtons&#x27;] &#x3D;
            this.smartTableCustomActionButtons;
          return JSON.stringify(displayVal);
        },
        renderComponent: CustomActionsComponent,
        onComponentInitFunction: (instance: any) &#x3D;&gt; {
          instance.byCustomActionButtonClick.subscribe((data, rowData) &#x3D;&gt; {
            let customActionButton &#x3D; this.smartTableCustomActionButtons.filter(
              (actionButton) &#x3D;&gt; {
                return actionButton.id &#x3D;&#x3D;&#x3D; data.actionButton.id;
              },
            )[0];
            customActionButton.onClick(data.rowData);
          });
        },
        width: &#x27;15%&#x27;,
        filter: false,
      },
    },
    noDataMessage: &#x27;No entities found for selected filter&#x27;,
    pager: {
      display: false,
    },
    mode: &#x27;external&#x27;,
    actions: false,
  };

  constructor(
    route: ActivatedRoute,
    private uiVersioningService: UiVersioningControllerService,
    private dialogService: NbDialogService,
    private contextUpdateService: ContextUpdatesService,
    private customToastService: CustomToastService,
    private onAPIErrorService: OnAPIErrorService,
  ) {
    super(route);
  }

  OnPageInit(): void {
    this.fetchingEntity &#x3D; true;
    this.getDeletedEntities(10, false);
    // this.source.onChanged().subscribe((change) &#x3D;&gt; {
    //   if(this.selectedFilter !&#x3D;&#x3D; change?.filter?.[&#x27;filters&#x27;]?.[0]?.search) {
    //     this.filteredResults &#x3D; false;
    //   }
    //   if(change?.action &#x3D;&#x3D;&#x3D; &#x27;filter&#x27; &amp;&amp; change?.filter?.[&#x27;filters&#x27;]?.[0]?.search.length &gt; 0 &amp;&amp; !this.filteredResults) {
    //     this.selectedFilter &#x3D; change?.filter?.[&#x27;filters&#x27;]?.[0]?.search;
    //     this.filtered &#x3D; true;
    //     this.filteredResults &#x3D; true;
    //     this.pageNum &#x3D; -1;
    //     this.pageCount &#x3D; 0;
    //     this.getDeletedEntities(10, false)
    //   } else {
    //     this.filtered &#x3D; false;
    //     this.selectedFilter &#x3D; &#x27;&#x27;;
    //   }
    // })
  }

  changeDeleteStatus(data) {
    if (data?.rowData &amp;&amp; Object.keys(data?.rowData)?.length &gt; 0) {
      this.entities.forEach((entity) &#x3D;&gt; {
        if (
          entity[&#x27;id&#x27;] &#x3D;&#x3D;&#x3D; data?.rowData?.id &amp;&amp;
          typeof data.val &#x3D;&#x3D;&#x3D; &#x27;boolean&#x27;
        ) {
          entity[&#x27;delete&#x27;] &#x3D; data.val;
        }
      });
    }
    this.source.load([...this.entities]);

    if (data?.val &amp;&amp; this.deleteEntitiesId.indexOf(data?.rowData?.id) &lt; 0) {
      this.deleteEntitiesId.push(data?.rowData?.id);
    } else if (
      !data?.val &amp;&amp;
      this.deleteEntitiesId.indexOf(data?.rowData?.id) &gt;&#x3D; 0
    ) {
      this.deleteEntitiesId &#x3D; this.deleteEntitiesId.filter(
        (entity) &#x3D;&gt; entity !&#x3D;&#x3D; data?.rowData?.id,
      );
    }
    this.deleteLength &#x3D; this.deleteEntitiesId.length;
  }

  listenToActionButtonEvents(event) {
    if (event &#x3D;&#x3D;&#x3D; &#x27;delete-trash&#x27;) {
      this.dialogService.open(this.confirmDeleteAll, { context: null });
    }
  }

  selectDeselect(status) {
    this.deleteEntitiesId &#x3D; [];
    if (status &#x3D;&#x3D;&#x3D; &#x27;select&#x27;) {
      this.entities.forEach((entity) &#x3D;&gt; {
        entity.delete &#x3D; true;
        this.deleteEntitiesId.push(entity.id);
      });
      this.deleteLength &#x3D; this.entities.length;
      this.source.load([...this.entities]);
    }
    if (status &#x3D;&#x3D;&#x3D; &#x27;deselect&#x27;) {
      this.entities.forEach((entity) &#x3D;&gt; {
        entity.delete &#x3D; false;
      });
      this.deleteEntitiesId &#x3D; [];
      this.deleteLength &#x3D; 0;
      this.source.load([...this.entities]);
    }
  }

  openDeletePopup(data) {
    this.dialogService.open(this.confirmDelete, { context: { ...data } });
  }

  getDeletedEntities(perPage, restored) {
    this.fetchingEntity &#x3D; true;
    /*If this function is getting called after restoration of entities, we don&#x27;response need to increament page number as
      entities will be fetched again from start(page 0). Below conditional statement is for the same.
    */
    if (!restored) {
      /*pageNum is used for sending page number with api and will start from 0,
        but pageCount is only used for entity restoration purpose, so it starts from 1 as we need to
        multiply it by page size to get how many entities needs to be fetched after restore. ex. page 2 * 30 &#x3D; 60 entities*/
      this.pageNum &#x3D; this.pageNum + 1;
      this.pageCount &#x3D; this.pageCount + 1;
    }
    this.uiVersioningService
      .softDeletedEntitiesUsingGET({
        perPage: perPage,
        sortBy: &#x27;LAST_MODIFIED_DATE&#x27;,
        page: restored
          ? 0
          : this
              .pageNum /*if function is called after entity is restored, then we start from 0,
                                          otherwise normal page number increament continues*/,
      })
      .subscribe(
        (response) &#x3D;&gt; {
          if (response &amp;&amp; response?.length &gt; 0) {
            if (response.length &lt; 10) {
              this.showLoadMore &#x3D; false;
            }
            if (this.pageNum &#x3D;&#x3D;&#x3D; 0 || restored) {
              this.entities &#x3D; [];
            }
            response.forEach((entity) &#x3D;&gt; {
              /* setting names for different entitiyTypes as response structure for entity types is different*/
              let tempEntity &#x3D; {
                delete: false,
                id: entity.id,
                entityType: entity.entityType,
                lastModifiedDate: entity.lastModifiedDate,
              };
              const entityNameMap &#x3D; {
                TEMPLATE_INPUT: entity?.entity?.[&#x27;uid&#x27;],
                USER_GROUP: entity?.entity?.[&#x27;groupName&#x27;],
                ARTIFACT_CI: entity?.entity?.[&#x27;ciName&#x27;],
              };
              tempEntity[&#x27;name&#x27;] &#x3D;
                entityNameMap[entity.entityType] || entity?.entity?.[&#x27;name&#x27;];
              this.entities.push(tempEntity);
            });
          }
          if (this.entities?.length &gt; 0) {
            this.showEmptyState &#x3D; false;
            this.trashActionButtons.map((button) &#x3D;&gt; {
              if (button.id &#x3D;&#x3D;&#x3D; &#x27;delete-trash&#x27;) {
                button.invisible &#x3D; false;
              }
            });
          } else {
            this.showEmptyState &#x3D; true;
          }
          this.entities?.length &gt; 0
            ? this.source.load([...this.entities])
            : this.source.load([]);
          this.disableMore &#x3D; !(this.entities?.length &gt;&#x3D; 10);
          this.fetchingEntity &#x3D; false;
        },
        (error) &#x3D;&gt; {
          this.secondaryMsg &#x3D;
            error?.error?.message ||
            &#x27; There is some error fetching deleted entities&#x27;;
          this.primaryMsg &#x3D; &#x27;&#x27;;
          this.emptyStateLogo &#x3D; errorIcon;
          this.showEmptyState &#x3D; true;
          this.status &#x3D; &#x27;error&#x27;;
          this.fetchingEntity &#x3D; false;
        },
      );
  }

  loadCluster(entity) {
    this.entities.push({
      delete: false,
      name: entity.entity.name,
      id: entity.id,
      entityType: entity.entityType,
      lastModifiedDate: entity.lastModifiedDate,
    });
  }

  loadTemplate(entity) {
    this.entities.push({
      delete: false,
      name: entity.entity.uid,
      id: entity.id,
      entityType: entity.entityType,
      lastModifiedDate: entity.lastModifiedDate,
    });
  }

  OnPageLoad(p: Params): void {}

  customClicked(event) {
    this.dialogService.open(this.confirmRestore, { context: event });
  }

  clearTrash(ref) {
    this.clearTrashInProgress &#x3D; true;
    this.uiVersioningService.deleteAllSoftDeleteEntitiesUsingDELETE().subscribe(
      (response) &#x3D;&gt; {
        this.customToastService.success(&#x27;Entities deleted permanently&#x27;);
        ref.close();
        this.getDeletedEntities(10 * this.pageCount, true);
        this.deleteEntitiesId &#x3D; [];
        this.deleteLength &#x3D; 0;
        this.clearTrashInProgress &#x3D; false;
      },
      (error) &#x3D;&gt; {
        ref.close();
        this.clearTrashInProgress &#x3D; false;
        this.onAPIErrorService.onAPIError(
          error?.error?.message ||
            &#x27;An error occured while deleting the entities.&#x27;,
          error,
        );
      },
    );
  }

  restoreEntity(data, ref) {
    this.restoreInProgress &#x3D; true;
    this.uiVersioningService.restoreSoftDeleteUsingPOST(data.id).subscribe(
      (response) &#x3D;&gt; {
        this.customToastService.success(response);
        this.restoreInProgress &#x3D; false;
        this.deleteEntitiesId &#x3D; [];
        this.deleteLength &#x3D; 0;
        ref.close();
        this.getDeletedEntities(
          10 * this.pageCount,
          true,
        ); /*getting number of entities already loaded on page with single api call to keep ui consistent*/
        this.contextUpdateService.requestContextSwitcherRefresh();
      },
      (error) &#x3D;&gt; {
        ref.close();
        this.restoreInProgress &#x3D; false;
        this.onAPIErrorService.onAPIError(
          error?.error?.message || &#x27; Entity restore failed.&#x27;,
          error,
        );
      },
    );
  }

  openMultiPopup() {
    let dataToSend &#x3D; [];
    this.entities.forEach((entity) &#x3D;&gt; {
      if (entity.delete &#x3D;&#x3D;&#x3D; true) {
        dataToSend.push(entity);
      }
    });
    this.dialogService.open(this.multipleDelete, { context: dataToSend });
  }

  deleteSingleItem(data, ref) {
    this.deletionInProgress &#x3D; true;
    if (data?.id?.length &gt; 0) {
      let itemToDelete &#x3D; [data];
      this.deleteTrash(itemToDelete, ref);
    } else {
      this.customToastService.error(&#x27;Invalid entity id&#x27;);
    }
  }

  deleteMultipleItems(data, ref) {
    this.deletionInProgress &#x3D; true;
    this.deleteTrash([...data], ref);
  }

  deleteTrash(items, ref) {
    let deleteIds &#x3D; [];
    items?.forEach((item) &#x3D;&gt; {
      deleteIds.push(item?.id);
    });

    this.uiVersioningService
      .deleteSoftDeleteEntityUsingDELETE(deleteIds)
      .subscribe(
        (res) &#x3D;&gt; {
          this.deletionInProgress &#x3D; false;
          this.getDeletedEntities(10 * this.pageCount, true);
          this.deleteEntitiesId &#x3D; [];
          this.deleteLength &#x3D; 0;
          if (items.length &#x3D;&#x3D;&#x3D; 1) {
            this.customToastService.success(
              &quot;&#x27;&quot; + items[0].name + &quot;&#x27;&quot; + &#x27; deleted permanently&#x27;,
            );
          } else {
            this.customToastService.success(&#x27;Entities deleted permanently&#x27;);
          }
          ref.close();
        },
        (error) &#x3D;&gt; {
          ref.close();
          this.deletionInProgress &#x3D; false;
          this.onAPIErrorService.onAPIError(
            error?.error?.message || &#x27;Could not delete the entities&#x27;,
            error,
          );
        },
      );
  }
}
</code></pre>
    </div>
</div>








                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'interface';
            var COMPODOC_CURRENT_PAGE_URL = 'SoftDeleted.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
